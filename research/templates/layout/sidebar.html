{#
  Reusable sidebar navigation for authenticated pages.
  - Collapsible sections are controlled by the tiny script in layout/base.html.
  - Active link style is based on request.resolver_match.url_name checks.
#}
<aside class="fixed inset-y-0 left-0 z-30 w-72 border-r border-slate-700/80 bg-slate-900/95 px-4 py-5 shadow-2xl shadow-black/30">
  <div class="flex h-full flex-col overflow-y-auto pr-1">
    <div class="mb-5 rounded-lg border border-slate-700/80 bg-slate-800/70 px-4 py-3">
      <p class="text-xs font-semibold uppercase tracking-[0.2em] text-slate-400">Active Database</p>
      <h2 class="mt-1 truncate text-lg font-bold text-slate-100">{{ active_database.name|default:"No database selected" }}</h2>
      <p class="mt-1 text-xs font-medium uppercase tracking-wide text-primary">StrainDB</p>
    </div>

    <a
      href="{% url 'strain_create' %}"
      class="mb-6 inline-flex w-full items-center justify-center rounded-md border border-primary/40 bg-primary px-3 py-2 text-sm font-semibold text-slate-950 transition hover:opacity-90"
    >
      + New Strain
    </a>

    <nav class="space-y-5 text-sm">
      {# PRIMARY WORK remains expanded by default (non-collapsible group). #}
      <section>
        <h3 class="sidebar-group-heading">Primary Work</h3>
        <div class="mt-2 space-y-1">
          <a href="{% url 'dashboard' %}" class="sidebar-link {% if request.resolver_match.url_name == 'dashboard' %}sidebar-link-active{% endif %}">Dashboard</a>
          <a href="{% url 'search-results' %}" class="sidebar-link {% if request.resolver_match.url_name == 'search-results' %}sidebar-link-active{% endif %}">Search</a>
          <a href="{% url 'strain_list' %}" class="sidebar-link {% if request.resolver_match.url_name == 'strain_list' or request.resolver_match.url_name == 'strain-list' %}sidebar-link-active{% endif %}">Strains</a>
          <a href="{% url 'activity_log' %}" class="sidebar-link {% if request.resolver_match.url_name == 'activity_log' or request.resolver_match.url_name == 'activity-feed' %}sidebar-link-active{% endif %}">Activity</a>
        </div>
      </section>

      <div class="sidebar-section">
        <button
          type="button"
          class="sidebar-toggle flex items-center justify-between w-full px-3 py-2 text-xs uppercase tracking-wider text-gray-400 hover:text-white"
          data-target="data-section"
          aria-expanded="true"
        >
          <span>DATA</span>
          <svg
            class="w-3 h-3 transition-transform duration-200"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div id="data-section" class="sidebar-collapse mt-2 space-y-1">
          <a href="{% url 'organism_list' %}" class="sidebar-link {% if request.resolver_match.url_name == 'organism_list' %}sidebar-link-active{% endif %}">Organisms</a>
          <a href="{% url 'plasmid_list' %}" class="sidebar-link {% if request.resolver_match.url_name == 'plasmid_list' %}sidebar-link-active{% endif %}">Plasmids</a>
          <a href="{% url 'location_list' %}" class="sidebar-link {% if request.resolver_match.url_name == 'location_list' %}sidebar-link-active{% endif %}">Locations</a>
          <a href="{% url 'file_list' %}" class="sidebar-link {% if request.resolver_match.url_name == 'file_list' %}sidebar-link-active{% endif %}">Files</a>
        </div>
      </div>

      <div class="sidebar-section">
        <button
          type="button"
          class="sidebar-toggle flex items-center justify-between w-full px-3 py-2 text-xs uppercase tracking-wider text-gray-400 hover:text-white"
          data-target="team-section"
          aria-expanded="true"
        >
          <span>TEAM</span>
          <svg
            class="w-3 h-3 transition-transform duration-200"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div id="team-section" class="sidebar-collapse mt-2 space-y-1">
          <a href="{% url 'organization-members' %}" class="sidebar-link {% if request.resolver_match.url_name == 'organization-members' %}sidebar-link-active{% endif %}">Organization Members</a>
        </div>
      </div>

      <div class="sidebar-section">
        <button
          type="button"
          class="sidebar-toggle flex items-center justify-between w-full px-3 py-2 text-xs uppercase tracking-wider text-gray-400 hover:text-white"
          data-target="admin-section"
          aria-expanded="true"
        >
          <span>ADMINISTRATION</span>
          <svg
            class="w-3 h-3 transition-transform duration-200"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>
        <div id="admin-section" class="sidebar-collapse mt-2 space-y-1">
          <a href="{% url 'custom_field_list' %}" class="sidebar-link {% if request.resolver_match.url_name == 'custom_field_list' or request.resolver_match.url_name == 'custom-field-definition-list' %}sidebar-link-active{% endif %}">Custom Fields</a>
          <a href="{% url 'csv_import' %}" class="sidebar-link {% if request.resolver_match.url_name == 'csv_import' or request.resolver_match.url_name == 'csv_upload' %}sidebar-link-active{% endif %}">Import / Export</a>
          <a href="{% url 'audit_log' %}" class="sidebar-link {% if request.resolver_match.url_name == 'audit_log' %}sidebar-link-active{% endif %}">Audit Log</a>
          <a href="{% url 'database_settings' %}" class="sidebar-link {% if request.resolver_match.url_name == 'database_settings' %}sidebar-link-active{% endif %}">Database Settings</a>
          <a href="{% url 'admin:index' %}" class="sidebar-link {% if request.resolver_match.url_name == 'index' and request.resolver_match.namespace == 'admin' %}sidebar-link-active{% endif %}">Django Admin</a>
        </div>
      </div>

      <section class="pt-3 border-t border-slate-700/80">
        <h3 class="sidebar-group-heading">Global</h3>
        <div class="mt-2 space-y-1">
          <a href="{% url 'select_database' %}" class="sidebar-link {% if request.resolver_match.url_name == 'select_database' or request.resolver_match.url_name == 'database-select' %}sidebar-link-active{% endif %}">Select Database</a>
          <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit" class="sidebar-link w-full text-left">Logout</button>
          </form>
        </div>
      </section>
    </nav>
  </div>
</aside>
